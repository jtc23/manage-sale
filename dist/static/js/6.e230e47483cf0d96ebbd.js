webpackJsonp([6],{"5/xu":function(e,t,s){"use strict";var a=s("ZQlS"),n=s("Q+i8"),r=s("VU/8"),i=r(a.a,n.a,!1,null,null,null);t.a=i.exports},"5LkN":function(e,t,s){"use strict";var a=s("Xxa5"),n=s.n(a),r=s("exGp"),i=s.n(r),o=s("Dd8w"),l=s.n(o),c=s("NYxO"),u=s("5/xu"),p=s("5Oio");s("sUAH");t.a={data:function(){return{page:1,size:15,selections:[],refreshLoading:!1,mutipleDel:!1,loading:!1,title:""}},head:{title:function(){return{inner:this.title}}},watch:{$route:function(e,t){"MessageSingleList"===e.name&&(this.type=e.params.type,this.getTitle(),this.getMessages({type:e.params.type,page:this.page}))}},components:{Refresh:u.a,ListTable:p.a},computed:l()({},Object(c.c)({messages:"messages",total:"total",per_page:"per_page",deleteStatus:"deleteStatus"})),methods:l()({},Object(c.b)({getTypeMessages:"getMessages",deleteMessages:"deleteMessages"}),{getTitle:function(){if("MessageList"===this.$route.name||"MessageSingleList"===this.$route.name){switch(this.$route.params.type){case"recommend":this.title="推荐消息";break;case"reward":this.title="奖金消息";break;case"cash":this.title="红包消息";break;case"other":this.title="其他消息";break;default:this.title="全部消息"}this.$emit("updateHead")}},getMessages:function(e){var t=this,s=e.type,a=e.page,r=void 0===a?1:a;return i()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=7;break}return t.$Progress.start(),t.loading=!0,e.next=5,t.getTypeMessages({type:s,page:r});case 5:t.loading=!1,t.$Progress.finish();case 7:case"end":return e.stop()}},e,t)}))()},refresh:function(){var e=this;return i()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.refreshLoading=!0,t.next=3,e.getMessages({type:e.type,page:e.page});case 3:e.refreshLoading=!1;case 4:case"end":return t.stop()}},t,e)}))()},handleMultipeDel:function(){var e=this;return i()(n.a.mark(function t(){var s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.selections.length,t.prev=1,t.next=4,e.$confirm("确定要删除选中的"+s+"条数据吗？","提示");case 4:return e.loading=!0,t.next=7,e.deleteMessages({ids:e.selections,page:e.page});case 7:if("failed"===e.deleteStatus){t.next=13;break}return t.next=10,e.getTypeMessages({type:e.type,page:e.page});case 10:e.$message({type:"success",message:"删除成功！"}),t.next=14;break;case 13:e.$message({type:"error",message:"删除失败！"});case 14:e.selections=[],e.mutipleDel=!1,e.loading=!1,t.next=21;break;case 19:t.prev=19,t.t0=t.catch(1);case 21:case"end":return t.stop()}},t,e,[[1,19]])}))()},handleSelect:function(e){e.length>1?(this.mutipleDel=!0,this.selections=e.map(function(e){return e.id})):this.mutipleDel=!1},handleDelSuccess:function(){this.getMessages({type:this.type,page:this.page}),this.$router.push({query:{page:page}})},changePage:function(e){this.page=e,this.getMessages({type:this.type,page:this.page}),this.$router.push({query:{page:e}})}}),created:function(){"MessageSingleList"===this.$route.name&&(this.type=this.$route.params.type,this.getTitle(),this.getMessages({type:this.$route.params.type,page:this.page}))}}},"5Oio":function(e,t,s){"use strict";var a=s("CN+C"),n=s("o0wV"),r=s("VU/8"),i=r(a.a,n.a,!1,null,null,null);t.a=i.exports},"9jvi":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"messages"},[s("div",{staticClass:"pull-right"},[s("transition",{attrs:{name:"el-fade-in"}},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.mutipleDel,expression:"mutipleDel"}],attrs:{type:"primary",size:"mini",plain:""},on:{click:e.handleMultipeDel}},[e._v("批量删除")])],1),e._v(" "),s("refresh",{attrs:{loading:e.refreshLoading,type:"danger"},on:{refresh:e.refresh}})],1),e._v(" "),s("h2",[e._v(e._s(e.title))]),e._v(" "),s("list-table",{attrs:{messages:e.messages,type:e.$route.params.type,total:e.total,loading:e.loading},on:{select:e.handleSelect,delSuccess:e.handleDelSuccess,changePage:e.changePage}})],1)},n=[],r={render:a,staticRenderFns:n};t.a=r},"CN+C":function(e,t,s){"use strict";var a=s("Xxa5"),n=s.n(a),r=s("exGp"),i=s.n(r),o=s("sUAH"),l=s("vMJZ"),c=s("a3K0");t.a={props:["messages","type","total","loading"],data:function(){return{userDetail:{},userDialogVisible:!1,userDetailLoading:!1}},components:{UserDetail:c.a},methods:{goRecommendDetail:function(e){this.$router.push({name:"CustomerDetail",params:{id:e,cache:!1}})},showDetail:function(e){var t=this;return i()(n.a.mark(function s(){var a,r;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t.userDialogVisible=!0,s.next=3,l.a.getUserDetail(e);case 3:a=s.sent,r=a.data,t.userDetail=r;case 6:case"end":return s.stop()}},s,t)}))()},getPostDetail:function(e){this.$router.push({name:"ArticleDetail",params:{id:e,cache:!1}})},deleteNotify:function(e){var t=this;return i()(n.a.mark(function s(){return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,t.$confirm("确认要删除这条消息吗？");case 3:o.a.deleteNotifies(e),t.$message({type:"success",message:"删除成功！"}),t.$emit("delSuccess"),s.next=10;break;case 8:s.prev=8,s.t0=s.catch(0);case 10:case"end":return s.stop()}},s,t,[[0,8]])}))()},handleSelect:function(e){this.$emit("select",e)},changePage:function(e){this.$emit("changePage",e)}},mounted:function(){}}},P090:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("5LkN"),n=s("9jvi"),r=s("VU/8"),i=r(a.a,n.a,!1,null,null,null);t.default=i.exports},"Q+i8":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement;return(e._self._c||t)("el-button",{attrs:{size:e.size,icon:"el-icon-refresh",type:e.type,plain:"",loading:e.loading,timeout:e.timeout,disabled:e.refreshDisable},on:{click:e.refresh}},[e._v(e._s(e.refreshText)+"\n")])},n=[],r={render:a,staticRenderFns:n};t.a=r},ZQlS:function(e,t,s){"use strict";t.a={props:{type:{type:String,default:"primary"},size:{type:String,default:"mini"},loading:{type:Boolean,default:!1},timeout:{type:Number,default:5e3}},data:function(){return{refreshText:"刷新",refreshDisable:!1}},methods:{refresh:function(){var e=this;this.$emit("refresh"),this.refreshText=5,this.refreshDisable=!0;var t=window.setInterval(function(){e.refreshText-=1},1e3);window.setTimeout(function(){clearInterval(t),e.refreshText="刷新",e.refreshDisable=!1},this.timeout)}}}},a3K0:function(e,t,s){"use strict";var a=s("q83M"),n=s("l/+F"),r=s("VU/8"),i=r(a.a,n.a,!1,null,null,null);t.a=i.exports},"l/+F":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:"用户详细信息",visible:e.visible,"element-loading-text":"玩命加载中"},on:{close:function(t){e.$emit("close")},open:function(t){e.$emit("open")}}},[s("el-form",{staticClass:"form-detail",attrs:{model:e.userDetail}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"用户名"}},[s("span",[e._v(e._s(e.userDetail.username?e.userDetail.username:"无名氏"+e.userDetail.id))])])],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"性别"}},[s("span",[e._v(e._s(1===e.userDetail.gender?"男":"女"))])])],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"电话"}},[s("span",[e._v(e._s(e.userDetail.phone))])])],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"银行卡号"}},[s("span",[e._v(e._s(e.userDetail.bank_code))])])],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"上次登录时间"}},[s("span",[e._v(e._s(e.userDetail.last_login))])])],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"注册时间"}},[s("span",[e._v(e._s(e.userDetail.created_at))])])],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"开户行"}},[s("span",[e._v(e._s(e.userDetail.bank_name))])]),e._v(" "),s("el-form-item",{attrs:{label:"身份证号"}},[s("span",[e._v(e._s(e.userDetail.id_card))])]),e._v(" "),s("el-form-item",{attrs:{label:"推荐总数量"}},[s("el-button",{attrs:{type:"text"},on:{click:e.goUserCustomers}},[e._v(e._s(e.userDetail.recommend_count))])],1)],1)],1)},n=[],r={render:a,staticRenderFns:n};t.a=r},o0wV:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.messages,"empty-text":"暂无消息","element-loading-text":"玩命加载中"},on:{select:e.handleSelect,"select-all":e.handleSelect}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{type:"index",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{prop:"title",label:"标题"},scopedSlots:e._u([{key:"default",fn:function(t){return["recommend"===t.row.type?s("span",[s("el-tag",{staticClass:"notify-tag",attrs:{size:"mini"}},[e._v("推荐")]),e._v("用户"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.showDetail(t.row.notify.sender)}}},[e._v(e._s(t.row.username?t.row.username:"无名氏"+t.row.notify.sender))]),e._v(e._s(t.row.action)+"了"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.goRecommendDetail(t.row.notify.target)}}},[e._v(e._s(t.row.targets))]),e._v("的"+e._s(t.row.target_type)+"信息")],1):e._e(),e._v(" "),"user"===t.row.type?s("span",[s("el-tag",{staticClass:"notify-tag",attrs:{size:"mini",type:"success"}},[e._v("用户")]),e._v("用户"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.showDetail(t.row.notify.sender)}}},[e._v(e._s(t.row.username?t.row.username:"无名氏"+t.row.notify.sender))]),e._v(e._s(t.row.action)+"了个人信息")],1):e._e(),e._v(" "),"article"===t.row.type?s("span",[s("el-tag",{staticClass:"notify-tag",attrs:{size:"mini",type:"info"}},[e._v("文章")]),e._v("用户"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.showDetail(t.row.notify.sender)}}},[e._v(e._s(t.row.username?t.row.username:"无名氏"+t.row.notify.sender))]),e._v(e._s(t.row.action)+"了文章"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.getPostDetail(t.row.notify.target)}}},[e._v(e._s(t.row.targets))])],1):e._e(),e._v(" "),"progress"===t.row.type?s("span",[s("el-tag",{staticClass:"notify-tag",attrs:{size:"mini",type:"warning"}},[e._v("进展")]),e._v("用户"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.showDetail(t.row.notify.sender)}}},[e._v(e._s(t.row.username?t.row.username:"无名氏"+t.row.notify.sender))]),e._v(e._s(t.row.action)+"了"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.goRecommendDetail(t.row.targets.id)}}},[e._v(e._s(t.row.targets.username))]),e._v("的进展信息")],1):e._e(),e._v(" "),"cash"===t.row.type?s("span",[s("el-tag",{staticClass:"notify-tag",attrs:{size:"mini",type:"danger"}},[e._v("红包")]),e._v("用户"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.showDetail(t.row.notify.sender)}}},[e._v(e._s(t.row.username?t.row.username:"无名氏"+t.row.notify.sender))]),e._v(e._s(t.row.action)+"了"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.goRecommendDetail(t.row.targets.id)}}},[e._v(e._s(t.row.targets.username))]),e._v("的红包")],1):e._e(),e._v(" "),"private"===t.row.type?s("span",[s("el-tag",{staticClass:"notify-tag",attrs:{size:"mini"}},[e._v("私信")]),e._v("用户"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.showDetail(t.row.notify.sender)}}},[e._v(e._s(t.row.username?t.row.username:"无名氏"+t.row.notify.sender))]),e._v(e._s(t.row.action)+"的一条信息")],1):e._e(),e._v(" "),"reward"===t.row.type?s("span",[s("el-tag",{staticClass:"notify-tag",attrs:{size:"mini",type:"danger"}},[e._v("奖金")]),e._v("用户"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.showDetail(t.row.notify.sender)}}},[e._v(e._s(t.row.username?t.row.username:"无名氏"+t.row.notify.sender))]),e._v(e._s(t.row.action)+"了"),s("el-button",{attrs:{type:"text"},on:{click:function(s){e.goRecommendDetail(t.row.targets.id)}}},[e._v(e._s(t.row.targets.username))]),e._v("的奖金")],1):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.notify.created_at))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"},on:{click:function(s){e.deleteNotify(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("div",{staticClass:"block pull-right"},[s("el-pagination",{attrs:{"page-sizes":[15],layout:"total, prev, pager, next",total:e.total,"page-size":15},on:{"current-change":e.changePage}})],1),e._v(" "),s("user-detail",{attrs:{userDetail:e.userDetail,visible:e.userDialogVisible,loading:e.userDetailLoading},on:{"update:visible":function(t){e.userDialogVisible=t},close:function(t){e.userDialogVisible=!1}}})],1)},n=[],r={render:a,staticRenderFns:n};t.a=r},q83M:function(e,t,s){"use strict";t.a={props:{visible:{type:Boolean,default:!1},userDetail:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},methods:{goUserCustomers:function(){this.$router.push({name:"CustomerList",query:{user_id:this.userDetail.id},params:{cache:!1}}),this.$emit("update:visible",!1)}}}}});
//# sourceMappingURL=6.e230e47483cf0d96ebbd.js.map